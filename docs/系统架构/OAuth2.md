@autoHeader: 2.1.1.1.1.1

<p align="right">update time : {docsify-updated}</p>

> [!Note]
>
> OAuth是一个关于授权（authorization）的开放网络标准，用来授权第三方应用获取用户数据，是目前最流行的授权机制，它当前的版本是2.0

## 基础

### OAuth2.0

在OAuth2.0中“O”是Open的简称，表示“开放”的意思。Auth表示“授权”的意思，所以连起来OAuth表示“开放授权”的意思，它是一个关于授权（authorization）的开放网络标准，在全世界得到广泛应用。用一句话总结来说，OAuth2.0是一种授权协议。

OAuth允许用户授权第三方应用访问他存储在另外服务商里的各种信息数据，而这种授权不需要提供用户名和密码提供给第三方应用。<font color=red>**第三方应用只有在获得授权之后，才可以进一步访问授权者的数据。**</font>

### 组成结构及名词定义

![image-20231107094116603](OAuth2.assets/image-20231107094116603.png)

- 第三方应用：要获取用户（资源拥有者）存储在服务提供商里的资源的实例，通常是客户端，这里我们的万视达App就是第三方应用；
- 服务提供者：存储用户（资源拥有者）的资源信息的地方，向第三方应用提供用户相关信息的服务方，例如三方登录时的微信、QQ;
- 用户/资源拥有者：拿三方登录来说，指的是在微信或QQ中注册的用户；

**名词定义**

1. **Third-party application** *：第三方应用客户端， 扮演获取资源服务器数据信息的加色
2. **HTTP service**:服务提供商，例如微信
3. **Resource Owner**：用户/资源拥有者，例如在微信中注册的用户
4. **Authorization server**:认证服务器，在资源拥有者授权后,向客户端授权(颁发 access token)的服务器，负责向第三方应用提供授权许可凭证code、令牌token等
5. **Resource server**:资源服务器，存放用户生成的资源的服务器。它与认证服务器，可以是同一台服务器，也可以是不同的服务器。提供给第三方应用注册接口，需要提供给第三方应用app_id和app_secret，提供给第三方应用开放资源的接口。

### 解决的问题

用户登录应用时传统的方式是用户直接进入客户端应用的登录页面输入账号和密码，但有的用户感觉注册后再登录比较繁琐麻烦，于是用户选择使用相关社交账号（微信、QQ、微博）登录，这种方式通过用户的账号和密码去相关社交账号里获取数据存在严重的问题缺陷。

1、使用OAuth2.0可以避免向第三方暴露账号密码

2、第三方应用拥有了用户微信的所有权限，用户没法限制第三方应用获得授权的范围和有效期；因此OAuth2.0可以限制授权第三方应用获取微信部分功能，比如只可以获取用户信息，但不可以获取好友列表，有需求时再申请授权访问好友列表的权限

3、如果某个企业拥有多个应用系统平台，那么每个系统都需要设置一个账号密码，这种操作对于用户来说时繁琐麻烦的，没登录一个系统平台都要输入相应的账号密码，那么可不可以做一个平台，使任意用户可以在这个平台上注册了一个帐号以后，随后这个帐号和密码自动登记到这个平台中作为公共帐号，使用这个账号可以访问其它的已经授权访问的系统。在这种背景下，OAuth2.0协议就诞生了，使用OAuth2.0实现单点登录。

### 应用场景

现在各大开放平台，如微信开放平台、腾讯开放平台、百度开放平台等大部分的开放平台都是使用的**OAuth 2.0**协议作为支撑

1. 客户端App使用三方登录；
2. 微信小程序登录授权；
3. 多个服务的统一登录认证中心、内部系统之间受保护资源请求

## 原理解析

### 授权流程

![image-20231107095609119](OAuth2.assets/image-20231107095609119.png)



