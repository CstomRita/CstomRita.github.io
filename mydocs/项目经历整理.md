# 非技术

## 个人介绍

各位老师，大家上午/下午好！首先我做一个自我介绍。

我叫常思腾，本科毕业于北京科技大学物联网工程专业，2020年硕士毕业于北京邮电大学电子与通信工程专业，毕业后进入中国航天科技集团下属的二级单位，中国四维测绘技术有限公司工作，现已工作三年，主要技术栈是从事JavaWeb后端的研发工作。

工作期间，参与了公司两部分的业务研发工作，第一部分遥感云平台业务，在其中研发影像数据管理模块，向用户提供产品数据相关的服务接口；第二部分是针对整个卫星数据处理流程，研发任务管理调度子系统，驱动各个生产模块和流程监控。这些内容均是使用Java语言和Spring相关框架完成，目前也都在线上平稳运行。此外，还负责了一些线下工程项目的交付、集团自主研发项目申报材料编写等相关工作。

这就是我基本信息和相关工作经历，谢谢大家！

## 离职原因

对于企业来讲：

因为公司架构调整和企业改革的多重因素，导致现在的工作多数是重复性的文字工作，但我自己本身想要再多学习成长一些吧，希望能有别的机会吧。

## 你的优缺点

􏰗􏳕􏲤􏰗􏴻􏰐􏰋􏳎􏳐􏰜􏴐􏵲􏲫􏰏􏰗􏲛􏱛􏰬􏸆􏰜􏰝􏰅􏳝􏷭􏳮􏳯􏱺􏳝􏷭􏲊􏲋􏵛􏵇􏾜􏲊􏾝􏰲􏰋􏲄􏰨􏰏􏵑 􏲽􏾞􏴆􏰹􏳤􏳤􏵲􏲫􏵕􏲎􏸣􏲣􏰝􏰅􏲪􏳎􏾟􏰋􏰆􏰳􏵧􏵔􏰜􏳟􏲤􏲅􏷮􏱛􏾠􏰏􏰗􏰶􏰬􏸆􏱚􏳡􏳢􏳝􏾡􏾢􏱺􏳝 􏾣􏾤􏰏􏵲􏲠􏳤􏾥􏴀􏲪􏳎􏾟我认为我最大的优点是会坚持，我相信生活是一个不断沉淀、不断积累进而厚积薄发的过程，只有脚踏实地地坚持才能变成一个更优秀的人。也正是因为这种信念，我在生活中可以不焦躁、不气馁，坚定地迈向更优秀的自己。

我最大的缺点是不够果断，我在行动之前总会考虑很多情况，在行动与不行动开始之前会做利弊的权衡，到最后甚至放弃行动，导致丧失了很多机会。当我意识到这个缺点会让我丧失更多机会的时候，我开始正视自己，我会对自己进行一次理性的对话：你觉得这件事是不是应该去做，如果应该去做那就去做。这种方式对我很受用，也是我在摸索如何改进过程中的最终方案。虽然我还没有做到当机立断的程度，依然偶尔会陷入到过度考虑的情况，但是我会通过在脑海里设置这么一种机制来及时修正自己的状态。我也希望可以在这方面继续改进，不要因为过多的庸人自扰阻碍前进的脚步。

> 举个例子：
>
> 从小事上来讲，就写一封邮件、发一个短信的措辞问题，我都会重复看两遍，有没有什么纰漏。就连平时买东西也会比较纠结。
>
> 再比如，团队里要选一个人做汇报，我本身是想去的，但是我不能做到当机立断，我会在脑子里想很多，比如能不能做到，需要做什么，我具备什么，能不能满足...这些，我往往需要一个时间来帮助自己做决定。如果团队里没有人表现呢，在这个时间段里我也就能抓到机会。但是很多情况下，是有更加果断的人抢在我前面的，那我也就丧失了这样的机会

## 为什么选择这里(不去互联网)

国企类的：

首先在知识积累方面，我在学习和成长过程中积累了研发能力，在技术上的不足之处，我可以较快地弥补。其次，国企类的大型企业，在业务线还是技术层面都经过时间的积累沉淀，发展地稳定完善。比起频繁地跳动，我更偏向在公司内稳定的积累成长。



## 有什么问题想问

1、业务和工作内容是什么呢？

2、评级和发展路线是什么样的？



## 期望薪资(todo)

首先我之前也是在国企，我觉得国企间的薪酬成分差不多的。

我目前年收入大概是在32 3W，也是希望能维持现有水平 不下降，但有明显的岗位薪酬体系，评级和薪酬的晋升关系之类的。

# 技术类

工作期间主要参与了公司两部分业务研发。

## 遥感云平台系统

### 介绍

第一个业务叫做遥感云平台系统，这个业务是面向互联网用户，提供卫星数据和服务能力。我在其中研发的是数据管理模块，向用户提供产品数据相关的服务API，具体内容可以分为四点：

1.1、第一点是研发遥感影像数据在线浏览接口。由于遥感影像数据文件都比较大，根据行业规范，数据通过xyz坐标系的三层结构进行组织，把影像地图分块，每个浏览接口是返回目标块数据，再交由前端渲染。在项目中，基于SpringBoot服务框架，将原始数据存储在华为云对象存储中，采用动态切片的思路处理用户的请求，仅当某个数据第一次被访问时进行影像分块这一耗时动作，同时增加缓存层提高对已被访问过的数据的访问性能。

1.2 、第二点是为了能提升用户请求目标块数据的性能，我们发现在请求链路里最耗时的是切块时对数据的读取操作，因此预先在数据文件中多写入一个数据头，在该数据头中建立了坐标点范围和数据范围间的索引关系，通过公有云上支持范围读取的特性，在动态处理时无需读取整个数据文件，只需读取目标范围数据来提升处理速度。

1.3、第三点是基于SpringBoot和Mybatis服务框架，提供数据管理、属性查询、空间查询等通用功能接口。

1.4、第四点是建立数据自动化运维链路。因为这块业务借助了公有云资源，数据需要在公有云上存储，这个链路的功能利用公司内网和公有云之间的专线，每日依据生产情况，实时向公有云上推送，并对推送生产情况进行监控统计。

### 技术难点

在遥感云平台系统项目中，主要的技术难题是在做数据在线浏览接口的时候，需要取得空间和时间的平衡点。

这部分的需求其实是一次优化改版，因为遥感影像数据文件比较大，在大文件中拿取一小块数据这个动作我们叫做切片，这个动作是比较耗时的，尤其是原始文件越大延时越大，所以在最初的版本里，业务的请求逻辑是预先切好所有的块数据，来绕开在请求中动态切片的动作，用户请求仅需要获取现有资源即可，来保障请求性能，但是带来了明显的资源利用的问题，由于我们在互联网上的业务是依托公有云的，平台每天新上传的数据很多，而比如有些偏远地区的数据，并没有多少人访问，但在原有的逻辑中这些数据依然要占用公有云存储，这就造成了很多公有云存储上资源的浪费，尤其是我们数据量是PB级别，公有云对象存储上的成本非常大。

> 华为云OBS数据存储的费用是1GB一个月0.14元，之前我们数据是PB级别的，总下来一年的费用要快两百万。

结合我们实际业务情况，就是大部分用户集中看的是一些核心城市，而且他们会聚焦于某些缩放级别去看细节，在这种业务情况下，有一部分的存储是可以被释放掉的。因此我们采用了动态的方式来实现这个接口：

第一步就是打通动态请求加缓存的处理链路。仅当某个数据第一次被访问时进行影像分块这一耗时动作，同时增加缓存层提高访问性能。

第二步就是针对影像分块处理步骤进行优化。最开始采用预先切片的技术路线也是因为分块这个步骤比较耗时，因为文件是顺序读取的，而且包含空间坐标信息，需要把整个文件读取到内存中才能拿到具体的坐标，进而进行采样处理，在面对大文件的时候，这个耗时就会更长。

那按照这个情况反推，优化的重点在于提高读取，尽可能读取小范围数据，由于我们的数据是借助公有云存储的，支持range范围读取的，基于这样的思路，预先在数据文件中多写入一个数据头，在该数据头中建立了坐标点范围和数据范围间的索引关系，通过索引关系定位到目标块需要读取的数据范围，进行范围读取，无需读取整个文件，进而缩短了请求中的处理时长。

原始的方案占据了3-4倍的存储空间，在一万并发下，响应请求上保障了50ms以内。

新方案由于增加了文件头，是原始文件的1.3倍左右，在一万并发下，响应请求上初次访问200ms以内，再次访问依然是50ms以内，实现时间和空间上的折中方案。

## 地面系统

### 介绍

第二个项目是在做卫星地面系统中的任务管理调度子系统的研发工作，这部分工作是将生产流程中的各个处理模块串行起来，并提供自动化的生产和监控，具体内容包括两点：

> https://juejin.cn/post/6844904167463485453#heading-0

1、第一点是基于SpringCloud和Mybatis的框架研发工作流引擎，配置生产任务的工作流模板和参数解析方式，来驱动各个节点的处理算法。其中，处理算法都运行在hadoop集群上，子系统中将生产任务分为高、中、低三个优先级等级，通过kafka按照优先级顺序向Hadoop集群远程提交算法处理任务、为任务分配内存等资源，并对每个生产任务处理进度及状态进行监控。

2、第二点是提供对生产记录的统计分析，创建后台任务，可以自定义时间段查看目标时段中生成了哪些地方的数据，以及和全国地图的覆盖情况。

### 技术难点

这个项目在于和算法模块的整合。

首先在于虽然处理流程是一样的，但是针对不同产品每个算法的处理方式和解析方式不同，同时由于算法模块来源于各个不同团队，所以他们的运行参数也并不是标准化的。因此需要对他们进行兼容。这里我们为每个算法创建了模板子例，在运行中通过标记的字段来选择对应的算法模板。

第二是算法模块的运行方式上。各个团队交付的算法成果均是一个hadoop jar包，需要调度模块去提交到Hadoop集群中运行。在之前的相似项目中，他们的技术方案是在集群中随机选取一个节点，通过模拟ssh和Hadoop jar的方法来提交任务。这种技术方案带来的问题：

1、第一是没有办法做任务和资源的管理和监控。有一些任务因为集群资源不够被卡死。

2、第二是hadoop jar的方式是阻塞式，会阻塞ssh进程直到算法处理完成，然而算法处理通常是非常耗时的，这会导致有连接数占满，任务提交不上去的风险。

因此在这个项目中重新设计了这部分架构，用异步的实现方式，设置独立的消费者从kafka中拿取任务信息，在集群外以远程非阻塞的方式提交任务，不等待任务执行，任务的执行状态由单独的监控模块来监控。

针对资源管理这块，通过Hadoop集群资源管理接口获取当前的利用情况，若当前利用情况不足以支撑下个任务的时候，则暂不提交任务，防止因为资源缺失导致任务卡死。通过这种方式来平衡集群资源和消费速度。

### 并发有多少

目前每日生产基本2千景数据，每日差不多3W处理任务。

由于数据驱动时间是错开的， 大部分是平峰的，在高峰时刻，每分钟可调度3000任务。

### 工作流引擎

Q：现有的工作引擎框架了解吗？

A：我大致了解过常用的工作流引擎有activiti。



Q：为什么不用现有的工作引擎框架？

A：像Activit这种工作流引擎框架在功能上很丰富，适合用于大量复杂的业务流程。但在我们项目场景中，处理算法流程是串行且固定的，activit相对来讲，框架太重了。因此选择了自行实现工作流流转。



### kafka如何实现的优先级排序

在项目中，针对三个级别的优先级创建了三个topic，先拉取高优先级topic的数据，只要有就一直消费，直到没有数据再消费低一级topic。消费低一级topic的过程中，如果发现有高一级topic消息到来，则转向消费高优先级消息。

 

Q：有没有其他方案？

A：

大致有以下方案

（一）consumer 各自拉取，使用优先级队列重新缓冲。

这种对内存要求很大，而且单纯靠内存，程序崩溃后难以找回未消费消息。

（二）先拉取高优先级topic的数据，只要有就一直消费，直到没有数据再消费低一级topic。消费低一级topic的过程中，如果发现有高一级topic消息到来，则转向消费高优先级消息。

该方案在高峰时段可能会导致低优先级消息完全失去消费机会，这种要看应用场景，比如在一些任务调度上，资源有限，高峰时段全部在高优先级任务上，也是符合设计的。

（三）实现相对的有序，先不考虑优先级，在高中低优先级consumer中循环拉取一批次，在该批次消费中，优先消费优先级高的。

该方案实现的是相对的有序，无法做到当高中低都有消息待消费时，集中全力先消费高优先级的消息。